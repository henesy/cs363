/*
This Commands Pane is for creating, editing, and executing batches of commands. To get started, use the [Open] button to load a batch of commands from the Demo folder. 

The Output Pane on the right is the default area where the output of a command is displayed. The pane is an html browser where text, html documents, and images can be displayed. Alternatively, in some cases the outputs can be saved to files or displayed in popup windows. 
*/

$CyDB:> list commands;


// Item 1;

<showtext>
$Saxon:> 
<Item1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in doc("U:/cs363/proj3/Student.xml")/Students/Student
	for $f in doc("U:/cs363/proj3/Instructor.xml")/Instructors/Instructor

	let $s := doc("U:/cs363/proj3/Person.xml")/Persons/Person[ID = $e/StudentID]/Name
	let $m := doc("U:/cs363/proj3/Person.xml")/Persons/Person[ID = $f/InstructorID]/Name

	where $e/MentorID = $f/InstructorID
	return
	<E> { $s, $m } </E>
}
</Item1>; 
</showtext>


//Item 2;

<showtext>
$Saxon:>
<Item2 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in distinct-values(doc("U:/cs363/proj3/Student.xml")/Students/Student/Classification)

	let $g := avg(doc("U:/cs363/proj3/Student.xml")/Students/Student[Classification=$e]/GPA)

	return <E><Classification>{$e}</Classification><GPA>{$g}</GPA></E>
}
</Item2>;
</showtext>


//Item 3;

<showtext>
$Saxon:>
<Item3 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $esid in distinct-values(doc("U:/cs363/proj3/Enrollment.xml")/Enrollments/Enrollment/StudentID)

	let $e := doc("U:/cs363/proj3/Student.xml")/Students/Student[StudentID=$esid]
	let $f := doc("U:/cs363/proj3/Instructor.xml")/Instructors/Instructor[InstructorID=$e/MentorID]
	let $ep := doc("U:/cs363/proj3/Person.xml")/Persons/Person[ID = $e/StudentID]
	let $fp := doc("U:/cs363/proj3/Person.xml")/Persons/Person[ID = $f/InstructorID]

	return <E><Mentor>{$fp/Name}</Mentor><Student>{$ep/Name}</Student></E>
}
</Item3>;
</showtext>


//Item 4;

<showtext>
$Saxon:>
<Item4 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in doc("U:/cs363/proj3/Student.xml")/Students/Student

	let $eg := doc("U:/cs363/proj3/Enrollment.xml")/Enrollments/Enrollment[StudentID = $e/StudentID]/Grade
	let $ep := doc("U:/cs363/proj3/Person.xml")/Persons/Person[ID = $e/StudentID]

	where $eg = "A"
	return <E>{$ep/Name}</E>
}
</Item4>;
</showtext>


//Item 5;

<showtext>
$Saxon:>
<Item5 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in doc("U:/cs363/proj3/Course.xml")/Courses/Course[PreReq = "CS311"]/CourseCode

	return <E>{$e}</E>
}
</Item5>;
</showtext>


//Item 6;

<showtext>
$Saxon:>
<Item6 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in distinct-values(doc("U:/cs363/proj3/Student.xml")/Students/Student/Classification)

	let $f := doc("U:/cs363/proj3/Student.xml")/Students/Student[Classification=$e]

	return <E><Classification>{$e}</Classification><Students>{$f}</Students></E>
}
</Item6>;
</showtext>

// NOTE: I renamed UniversityOODB(ODMG) to UniversityOODB in all cases to fix errors I had;

// Item 7;

<showtext>
$OOXQuery:> 
<Item7 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in doc("U:/cs363/proj3/UniversityOODB.xml")//Faculty[Salary>100000]
	return <E> { $e.Rank, $e.Name } </E>
}
</Item7>;
</showtext> 

// Item 8;

<showtext>
$OOXQuery:> 
<Item8 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in doc("U:/cs363/proj3/UniversityOODB.xml")//Student
	return <E> { $e.Name, $e.Mentor.Name } </E>
}
</Item8>;
</showtext>

// Item 9;

<showtext>
$OOXQuery:> 
<Item9>
{
	for $e in doc("U:/cs363/proj3/UniversityOODB.xml")//Faculty
	return <E><Mentor>{$e.Name}</Mentor>
		<Mentees>
		{
			for $f in $e.Mentoring
			return <Mentee>{$f.Classification, $f/GPA}</Mentee>
		}
		</Mentees>
	</E>
}
</Item9>;
</showtext>

// Item 10;

<showtext>
$OOXQuery:> 
<Item10 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
{
	for $e in doc("U:/cs363/proj3/UniversityOODB.xml")//Offering
	return <E> { $e.CourseInfo.CourseName, $e.Section, $e.Instructor.Name, $e.Enrollments } </E>
}
</Item10>;
</showtext>
